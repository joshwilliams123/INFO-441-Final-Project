<!DOCTYPE html>
<html>

<head>
    <title>Fantasy Leaderboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/stylesheets/style.css">
</head>

<body>
    <nav class="navbar navbar-light bg-light">
        <a href="homepage.html" class="navbar-brand">Back</a>
    </nav>
    <div class="container mt-4">
        <h2>Fantasy Points Leaderboard</h2>
        <table id="leaderboard" border="1" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Player</th>
                    <th>Team</th>
                    <th>Fantasy Points</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    <script>
        const leagueId = localStorage.getItem('selectedLeagueId');
        if (!leagueId) {
            document.querySelector('#leaderboard tbody').innerHTML = '<tr><td colspan="3">No league selected.</td></tr>';
        } else {
            fetch(`/api/leaderboard/${leagueId}`)
                .then(res => {
                    if (!res.ok) throw new Error('Failed to load leaderboard');
                    return res.json();
                })
                .then(data => {
                    const tbody = document.querySelector('#leaderboard tbody');
                    tbody.innerHTML = '';
                    data.forEach((team, idx) => {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `<td>${idx + 1}</td>
                        <td>${team.teamName}</td>
                        <td>${team.members.join(', ')}</td>
                        <td>${team.totalPoints}</td>`;
                        tbody.appendChild(tr);
                    });
                })
                .catch(err => {
                    document.querySelector('#leaderboard tbody').innerHTML = `<tr><td colspan="4">Error: ${err.message}</td></tr>`;
                });
        }
    </script>
</body>

</html>